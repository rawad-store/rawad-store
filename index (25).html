<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Ø¯Ù„ÙŠÙ„ - Daleel | Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø©</title>
    <meta name="description" content="Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø© Ù…Ø¹ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙØµÙ„Ø©"/>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Meta Tags for Social Media Sharing -->
    <meta property="og:title" content="Ø¯Ù„ÙŠÙ„ - Daleel | Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø©">
    <meta property="og:description" content="Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© - Ù…Ù†ØµØ© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªØ¬Ø§Ø±Ø¨ ÙˆØªØ³Ù‡ÙŠÙ„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©">
    <meta property="og:image" content="https://raw.githubusercontent.com/rawad-store/daleel/main/preview.jpg">
    <meta property="og:url" content="https://rawad-store.github.io/Daleel/">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="ar_AR">
    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Ø¯Ù„ÙŠÙ„ - Daleel | Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø©">
    <meta name="twitter:description" content="Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© - Ù…Ù†ØµØ© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªØ¬Ø§Ø±Ø¨ ÙˆØªØ³Ù‡ÙŠÙ„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/rawad-store/daleel/main/preview.jpg">
    
    <style>
        /* Ø£Ù†Ù…Ø§Ø· CSS ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
        :root {
            --primary: #2D5F7C;
            --secondary: #4A90E2;
            --accent: #F5A623;
            --text: #333;
            --bg: #F8F9FA;
            --white: #fff;
            --border: #E0E0E0;
            --shadow: 0 2px 12px rgba(0,0,0,.08);
            --success: #27AE60;
            --error: #E74C3C;
            --primary-color: #2D5F7C;
            --transition: all 0.3s ease;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }
        
        a {
            color: inherit;
            text-decoration: none;
            transition: var(--transition);
        }
        
        a:hover {
            opacity: 0.8;
        }
        
        header {
            position: sticky;
            top: 0;
            z-index: 50;
            background: var(--white);
            box-shadow: var(--shadow);
        }
        
        .nav {
            max-width: 1200px;
            margin: auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
        }
        
        .brand {
            display: flex;
            gap: 10px;
            align-items: center;
            font-weight: 700;
            color: var(--primary);
        }
        
        .actions {
            display: flex;
            gap: 8px;
        }
        
        .btn {
            border: none;
            border-radius: 8px;
            padding: .65rem 1rem;
            cursor: pointer;
            font-family: inherit;
            transition: var(--transition);
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-danger {
            background: var(--error);
            color: var(--white);
        }
        
        .btn-warning {
            background: #f39c12;
            color: var(--white);
        }
        
        .btn-icon {
            display: inline-flex;
            gap: .45rem;
            align-items: center;
        }
        
        .hero {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            padding: 40px 0;
            transition: var(--transition);
        }
        
        .hero .wrap {
            max-width: 1200px;
            margin: auto;
            padding: 0 16px;
            display: grid;
            gap: 16px;
        }
        
        .hero h1 {
            margin: 0 0 10px;
            font-size: 2.2rem;
        }
        
        .stats {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(255,255,255,.12);
            border: 1px solid rgba(255,255,255,.25);
            padding: 12px 16px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            transition: var(--transition);
        }
        
        .stat:hover {
            transform: scale(1.05);
        }
        
        .container {
            max-width: 1200px;
            margin: auto;
            padding: 24px 16px;
        }
        
        .search-container {
            position: relative;
            max-width: 600px;
            margin: 0 auto 20px;
        }
        
        .search-bar {
            display: flex;
            width: 100%;
        }
        
        .search-bar input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 8px 0 0 8px;
            font-family: inherit;
            outline: none;
            transition: var(--transition);
        }
        
        .search-bar input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 5px var(--primary);
        }
        
        .search-bar button {
            background: var(--primary);
            color: var(--white);
            border: none;
            padding: 0 20px;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--white);
            border-radius: 0 0 8px 8px;
            box-shadow: var(--shadow);
            max-height: 200px;
            overflow-y: auto;
            z-index: 10;
            display: none;
            transition: var(--transition);
        }
        
        .search-suggestion {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
            transition: var(--transition);
        }
        
        .search-suggestion:hover {
            background-color: #f5f5f5;
        }
        
        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø§Ù„Ø£ÙÙ‚ÙŠØ© */
        .horizontal-filters {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            padding: 15px 0;
            margin: 15px auto 20px;
            max-width: 600px;
            scrollbar-width: thin;
        }
        
        .horizontal-filters::-webkit-scrollbar {
            height: 6px;
        }
        
        .horizontal-filters::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 3px;
        }
        
        .filter-btn {
            padding: 10px 20px;
            background: var(--white);
            border: 2px solid var(--border);
            border-radius: 25px;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
            font-size: 14px;
            font-family: 'Cairo', sans-serif;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background: var(--primary);
            color: var(--white);
            border-color: var(--primary);
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--white);
            border-radius: 14px;
            box-shadow: var(--shadow);
            padding: 14px;
            position: relative;
            transition: var(--transition);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .meta {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            font-size: .9rem;
            color: #555;
            margin: .5rem 0;
        }
        
        .rating {
            display: flex;
            gap: 3px;
            margin: 8px 0;
            color: #FFC107;
        }

        .rating i {
            font-size: 1.2rem; /* ØªØ­Ø³ÙŠÙ† Ø­Ø¬Ù… Ø§Ù„Ù†Ø¬ÙˆÙ… */
        }
        
        .reviews {
            margin-top: 10px;
            border-top: 1px solid var(--border);
            padding-top: 10px;
        }
        
        .review-item {
            background: #f9f9f9;
            padding: 15px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø­Ø´Ùˆ */
            border-radius: 8px;
            margin-bottom: 15px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª */
            transition: var(--transition);
            border: 1px solid var(--border); /* Ø¥Ø¶Ø§ÙØ© Ø­Ø¯ÙˆØ¯ */
        }

        .review-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.05); /* ØªØ£Ø«ÙŠØ± hover */
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§ÙØ© */
            font-size: 0.95rem; /* ØªØ­Ø³ÙŠÙ† Ø­Ø¬Ù… Ø§Ù„Ø®Ø· */
            color: #444; /* Ù„ÙˆÙ† Ø£ØºÙ…Ù‚ Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
        }
        
        .review-header div:first-child {
            font-weight: 600; /* Ø¬Ø¹Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… bold */
        }

        .review-accuracy {
            margin-top: 5px;
            font-style: italic; /* Ø¥Ø¶Ø§ÙØ© Ù†Ù…Ø· Ù„Ø¯Ù‚Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª */
            color: #666;
        }

        .review-comment {
            margin-top: 10px;
            border-top: 1px dashed var(--border); /* Ø®Ø· ÙØ§ØµÙ„ Ù…Ù†Ù‚Ø· */
            padding-top: 10px;
            font-size: 0.95rem;
        }
        
        .empty {
            padding: 48px;
            text-align: center;
            color: #777;
            grid-column: 1 / -1;
        }
        
        .search-results-info {
            margin-bottom: 20px;
            text-align: center;
            color: #555;
        }
        
        .modal {
            position: fixed;
            inset: 0;
            display: none;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,.5);
            z-index: 100;
            padding: 16px;
            transition: var(--transition);
        }
        
        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .box {
            background: var(--white);
            border-radius: 14px;
            max-width: 520px;
            width: 100%;
            box-shadow: var(--shadow);
            overflow: hidden;
            max-height: 90vh;
            overflow-y: auto;
            animation: scaleIn 0.3s ease;
            -webkit-overflow-scrolling: touch;
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .box-header {
            padding: 14px 18px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .box-body {
            padding: 16px 18px;
        }
        
        .row {
            display: grid;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .row-2 {
            grid-template-columns: 1fr 1fr;
        }
        
        label {
            font-weight: 600;
            color: var(--primary);
        }
        
        input, select, textarea {
            width: 100%;
            padding: .7rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
            outline: none;
            transition: var(--transition);
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 5px var(--primary);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .f-end {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            margin-top: 10px;
        }
        
        .toast-wrap {
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 200;
        }
        
        .toast {
            background: var(--primary);
            color: var(--white);
            padding: .8rem 1rem;
            border-radius: 8px;
            margin-bottom: 8px;
            box-shadow: var(--shadow);
            animation: slideIn 0.3s ease;
            transition: var(--transition);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .toast.error {
            background: var(--error);
        }
        
        .toast.success {
            background: var(--success);
        }
        
        .contact-info {
            background: var(--white);
            padding: 20px;
            border-radius: 14px;
            box-shadow: var(--shadow);
            margin-top: 30px;
            text-align: center;
            transition: var(--transition);
        }
        
        .contact-info:hover {
            transform: translateY(-5px);
        }
        
        .contact-info h3 {
            color: var(--primary);
            margin-top: 0;
            margin-bottom: 10px;
        }
        
        .contact-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .contact-link {
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            color: var(--text);
            transition: var(--transition);
        }
        
        .contact-link:hover {
            color: var(--primary);
        }
        
        footer {
            background: var(--primary);
            color: var(--white);
            text-align: center;
            padding: 20px;
            margin-top: 40px;
        }
        
        .social-grid {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-card {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            background: var(--primary);
            color: var(--white);
            border-radius: 50%;
            font-size: 1.2rem;
            transition: var(--transition);
        }
        
        .social-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .disabled {
            opacity: 0.5;
            pointer-events: none;
        }
        
        /* Ø£Ù†Ù…Ø§Ø· Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
        #welcomeModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.75);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            font-family: 'Cairo', sans-serif;
        }
        
        .welcome-section {
            text-align: center;
            padding: 3rem 1rem;
            background: #f9f9f9;
        }
        
        .welcome-content {
            max-width: 750px;
            margin: auto;
        }
        
        .welcome-content h2 {
            color: #27ae60;
            font-size: 2rem;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .welcome-content p {
            color: #34495e;
            line-height: 1.8;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .btn-start {
            background: linear-gradient(135deg, #e67e22, #d35400);
            color: #fff;
            border: none;
            padding: 14px 35px;
            border-radius: 12px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        
        .btn-start:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 14px rgba(0,0,0,0.25);
        }
        
        .fadeItem {
            transition: opacity 0.8s ease, transform 0.8s ease;
            transform: translateY(20px);
            opacity: 0;
        }
        
        .fadeItem.show {
            opacity: 1 !important;
            transform: translateY(0);
        }
        
        @media (max-width: 768px) {
            .row-2 {
                grid-template-columns: 1fr;
            }
            
            .stats {
                justify-content: center;
            }
            
            .contact-links {
                flex-direction: column;
                align-items: center;
            }
            
            .hero h1 {
                font-size: 1.8rem;
            }
            
            .card-actions {
                flex-direction: column;
            }
            
            .horizontal-filters {
                gap: 8px;
            }
            
            .filter-btn {
                padding: 8px 16px;
                font-size: 13px;
            }
        }
        
        @media (max-width: 480px) {
            .nav {
                flex-direction: column;
                gap: 10px;
            }
            
            .hero h1 {
                font-size: 1.5rem;
            }
            
            .stat {
                flex: 1;
                min-width: 120px;
                text-align: center;
            }
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙˆØ£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
        .card-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .card-action-btn {
            flex: 1;
            text-align: center;
            min-width: 120px;
        }
        
        /* ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù„ØªÙƒÙˆÙ† Ø±Ø£Ø³ÙŠØ© ÙˆÙ…ØªØ¬Ø§ÙˆØ¨Ø© */
        #reviewsList {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
        }
        
        .review-item {
            width: 100%;
            box-sizing: border-box;
        }
        
        @media (max-width: 768px) {
            .review-item {
                padding: 12px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø­Ø´Ùˆ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            }
            
            .review-header {
                flex-direction: column; /* Ø¬Ø¹Ù„ Ø§Ù„Ø±Ø£Ø³ Ø±Ø£Ø³ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
                align-items: flex-start;
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <nav class="nav" role="navigation" aria-label="Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ">
            <div class="brand">ğŸ“ Ø¯Ù„ÙŠÙ„ <span style="font-weight:400;color:#777">| Ø¯Ù„ÙŠÙ„Ùƒ Ù„Ù„Ø®Ø¯Ù…Ø§Øª</span></div>
            <div class="actions">
                <button id="addServiceNav" class="btn btn-primary btn-icon" style="display:none" onclick="toggleAdd()" aria-label="Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©">â• Ø£Ø¶Ù Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„ØªÙ‡Ø§</button>
                <button id="loginBtn" class="btn btn-outline btn-icon" onclick="openAuth('login')" aria-label="ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„">Ø¯Ø®ÙˆÙ„</button>
                <button id="registerBtn" class="btn btn-primary btn-icon" onclick="openAuth('register')" aria-label="Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨">ØªØ³Ø¬ÙŠÙ„</button>
                <button id="logoutBtn" class="btn btn-outline btn-icon" style="display:none" onclick="logout()" aria-label="ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬">Ø®Ø±ÙˆØ¬</button>
            </div>
        </nav>
    </header>
    
    <!-- Hero Section -->
    <section class="hero" aria-labelledby="hero-title">
        <div class="wrap">
            <div>
                <h1 id="hero-title">Ø¯Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø©</h1>
                <p style="opacity:.9">Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ´Ø§Ø±Ùƒ ØªØ¬Ø±Ø¨ØªÙƒ Ù…Ø¹ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†</p>
            </div>
            <div class="stats">
                <div class="stat" aria-live="polite"><b id="statServices">0</b> Ø®Ø¯Ù…Ø©</div>
                <div class="stat" aria-live="polite"><b id="statUsers">0</b> Ù…Ø³ØªØ®Ø¯Ù…</div>
                <div class="stat" aria-live="polite"><b id="statReviews">0</b> ØªÙ‚ÙŠÙŠÙ…</div>
                <div class="stat"><button id="addServiceTop" class="btn btn-primary btn-icon" style="display:none" onclick="toggleAdd()" aria-label="Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©">â• Ø£Ø¶Ù Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„ØªÙ‡Ø§</button></div>
            </div>
        </div>
    </section>
    
    <!-- Main Content -->
    <main class="container" aria-label="Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ">
        <!-- Search Section -->
        <section class="search-container" aria-label="Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø®Ø¯Ù…Ø§Øª">
            <div class="search-bar">
                <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø®Ø¯Ù…Ø© (ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø¨Ø£ÙŠ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„ÙƒÙ„Ù…Ø© Ø£Ùˆ Ø¹Ø¯Ø© ÙƒÙ„Ù…Ø§Øª)..." aria-label="Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø«" />
                <button onclick="searchServices()" aria-label="Ø¨Ø­Ø«"><i class="fas fa-search"></i></button>
            </div>
            <div id="searchSuggestions" class="search-suggestions" role="listbox" aria-label="Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„Ø¨Ø­Ø«"></div>
            
            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø§Ù„Ø£ÙÙ‚ÙŠØ© -->
            <div class="horizontal-filters">
                <button class="filter-btn active" data-category="Ø§Ù„ÙƒÙ„" onclick="filterByCategory('Ø§Ù„ÙƒÙ„')">Ø§Ù„ÙƒÙ„</button>
                <button class="filter-btn" data-category="Ø­ÙƒÙˆÙ…ÙŠ" onclick="filterByCategory('Ø­ÙƒÙˆÙ…ÙŠ')">Ø­ÙƒÙˆÙ…ÙŠ</button>
                <button class="filter-btn" data-category="ØµØ­Ø©" onclick="filterByCategory('ØµØ­Ø©')">ØµØ­Ø©</button>
                <button class="filter-btn" data-category="ØªØ¹Ù„ÙŠÙ…" onclick="filterByCategory('ØªØ¹Ù„ÙŠÙ…')">ØªØ¹Ù„ÙŠÙ…</button>
                <button class="filter-btn" data-category="Ù…Ø§Ù„ÙŠ" onclick="filterByCategory('Ù…Ø§Ù„ÙŠ')">Ù…Ø§Ù„ÙŠ</button>
                <button class="filter-btn" data-category="Ø£Ø®Ø±Ù‰" onclick="filterByCategory('Ø£Ø®Ø±Ù‰')">Ø£Ø®Ø±Ù‰</button>
            </div>
        </section>
        
        <div id="searchResultsInfo" class="search-results-info" aria-live="polite"></div>
        
        <!-- Services Section -->
        <section id="services" class="grid" aria-label="Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª"></section>
        <div id="empty" class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®Ø¯Ù…Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹ â€” ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠØ¶ÙŠÙ Ø®Ø¯Ù…Ø© âœ¨</div>
        
        <!-- Contact Section -->
        <section class="contact-info" aria-label="Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„">
            <h3>Ù„Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h3>
            <p>ÙŠØ³Ø¹Ø¯Ù†Ø§ ØªÙˆØ§ØµÙ„ÙƒÙ… Ù…Ø¹Ù†Ø§ Ù„Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø£Ùˆ Ù…Ù‚ØªØ±Ø­Ø§Øª</p>
            <div class="contact-links">
                <a href="mailto:tarek500500@gmail.com" class="contact-link" aria-label="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
                    <i class="fas fa-envelope"></i> tarek500500@gmail.com
                </a>
                <a href="https://wa.me/+201126630356?text=Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£Ø±ÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø®Ø¯Ù…Ø§ØªÙƒÙ…" class="contact-link" target="_blank" rel="noopener noreferrer" aria-label="ÙˆØ§ØªØ³Ø§Ø¨">
                    <i class="fab fa-whatsapp"></i> ÙˆØ§ØªØ³Ø§Ø¨
                </a>
            </div>
        </section>
        
        <section style="text-align: center; margin-top: 30px;" aria-label="ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ">
            <h4 style="margin-bottom: 1.5rem; color: var(--primary-color); font-size: 1.3rem; font-weight: 600;">ØªØ§Ø¨Ø¹ÙˆÙ†Ø§ Ø¹Ù„Ù‰ ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</h4>
            <div class="social-grid">
                <a href="https://www.facebook.com/share/1FzKsPMMsG/" class="social-card" target="_blank" rel="noopener noreferrer" style="background-color: #1877f2; color: #fff; display: inline-flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%;" aria-label="ÙÙŠØ³Ø¨ÙˆÙƒ">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="https://rawad-store.github.io/konozalkhair/" class="social-card" target="_blank" rel="noopener noreferrer" style="background-color: #e63946; color: #fff; display: inline-flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%;" aria-label="Ù…Ø¤Ø³Ø³Ø© ÙƒÙ†ÙˆØ² Ø§Ù„Ø®ÙŠØ±">
                    <i class="fas fa-hand-holding-heart"></i>
                </a>
                <a href="https://www.facebook.com/share/18bfjxRbHH" class="social-card" target="_blank" rel="noopener noreferrer" style="background-color: #1877f2; color: #fff; display: inline-flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%;" aria-label="ÙÙŠØ³Ø¨ÙˆÙƒ">
                    <i class="fab fa-facebook-f"></i>
                </a>    
                <a href="https://rawad-store.github.io/" class="social-card" target="_blank" rel="noopener noreferrer" style="background-color: #2a9d8f; color: #fff; display: inline-flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%;" aria-label="Ù…ÙƒØªØ¨Ø© Ø±ÙˆØ§Ø¯ Ø³ØªÙˆØ±">
                    <i class="fas fa-book"></i>
                </a>
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer aria-label="ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø©">
        <p>Â© 2025 Ø¯Ù„ÙŠÙ„ - Daleel. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±ÙˆØ§Ø¯ Ø¨Ø§Ù„ØµÙˆØ©</p>
    </footer>
    
    <!-- Add Service Modal -->
    <div id="addModal" class="modal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="box" aria-modal="true" aria-labelledby="addModalTitle">
            <div class="box-header">
                <h3 style="margin:0" id="addModalTitle">Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                <button class="btn btn-outline" onclick="toggleAdd()">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
            <form id="serviceForm" class="box-body">
                <input type="hidden" id="editServiceId" value="">
                <div class="row">
                    <label for="svcName">Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©</label>
                    <input id="svcName" placeholder="Ù…Ø«Ø§Ù„: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¬ÙˆØ§Ø² Ø³ÙØ±" required aria-required="true" />
                </div>
                <div class="row row-2">
                    <div>
                        <label for="svcCat">Ø§Ù„Ù‚Ø³Ù…</label>
                        <select id="svcCat" required aria-required="true">
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…</option>
                            <option>Ø­ÙƒÙˆÙ…ÙŠ</option>
                            <option>ØµØ­Ø©</option>
                            <option>ØªØ¹Ù„ÙŠÙ…</option>
                            <option>Ù…Ø§Ù„ÙŠ</option>
                            <option>Ø£Ø®Ø±Ù‰</option>
                        </select>
                    </div>
                    <div>
                        <label for="svcLoc">Ø§Ù„Ù…ÙƒØ§Ù†</label>
                        <input id="svcLoc" placeholder="Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - Ø£Ø¨ÙˆØ­Ù…Ø§Ø¯" required aria-required="true" />
                    </div>
                </div>
                <div class="row">
                    <label for="svcDocs">Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                    <textarea id="svcDocs" placeholder="Ø§Ø°ÙƒØ± Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©..." required aria-required="true"></textarea>
                </div>
                <div class="row row-2">
                    <div>
                        <label for="svcCost">Ø§Ù„ØªÙƒÙ„ÙØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <input id="svcCost" placeholder="Ù…Ø«Ø§Ù„: 100 Ø¬Ù†ÙŠÙ‡"/>
                    </div>
                    <div>
                        <label for="svcDur">Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <input id="svcDur" placeholder="Ù…Ø«Ø§Ù„: 3-5 Ø£ÙŠØ§Ù…"/>
                    </div>
                </div>
                <div class="row">
                    <label for="svcNotes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <textarea id="svcNotes" placeholder="Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù…ÙÙŠØ¯Ø©..."></textarea>
                </div>
                <div class="f-end">
                    <button type="button" class="btn" onclick="toggleAdd()" aria-label="Ø¥Ù„ØºØ§Ø¡">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="submit" class="btn btn-primary btn-icon" id="serviceFormSubmit" aria-label="Ø­ÙØ¸ Ø§Ù„Ø®Ø¯Ù…Ø©">ğŸ’¾ Ø­ÙØ¸</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Review Modal -->
    <div id="reviewModal" class="modal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="box" aria-modal="true" aria-labelledby="reviewServiceName">
            <div class="box-header">
                <h3 style="margin:0">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©: <span id="reviewServiceName"></span></h3>
                <button class="btn btn-outline" onclick="closeReview()" aria-label="Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
            <div class="box-body">
                <form id="reviewForm">
                    <div class="row">
                        <label>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</label>
                        <div class="rating" id="ratingStars" role="radiogroup" aria-label="Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…">
                            <i class="far fa-star" data-rating="1" role="radio" aria-checked="false" tabindex="0"></i>
                            <i class="far fa-star" data-rating="2" role="radio" aria-checked="false" tabindex="-1"></i>
                            <i class="far fa-star" data-rating="3" role="radio" aria-checked="false" tabindex="-1"></i>
                            <i class="far fa-star" data-rating="4" role="radio" aria-checked="false" tabindex="-1"></i>
                            <i class="far fa-star" data-rating="5" role="radio" aria-checked="false" tabindex="-1"></i>
                        </div>
                        <input type="hidden" id="reviewRating" value="0" required aria-required="true" />
                    </div>
                    <div class="row">
                        <label for="reviewComment">Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <textarea id="reviewComment" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ø¹Ù† Ø§Ù„Ø®Ø¯Ù…Ø©..."></textarea>
                    </div>
                    <div class="row">
                        <label for="reviewAccuracy">Ù‡Ù„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØµØ­ÙŠØ­Ø©?</label>
                        <select id="reviewAccuracy" required aria-required="true">
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</option>
                            <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…ØŒ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØµØ­ÙŠØ­Ø©</option>
                            <option value="Ø¬Ø²Ø¦ÙŠØ§Ù‹">Ø¬Ø²Ø¦ÙŠØ§Ù‹ØŒ Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªØ­ØªØ§Ø¬ ØªØ­Ø¯ÙŠØ«</option>
                            <option value="Ù„Ø§">Ù„Ø§ØŒ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©</option>
                        </select>
                    </div>
                    <div class="f-end">
                        <button type="button" class="btn" onclick="closeReview()" aria-label="Ø¥Ù„ØºØ§Ø¡">Ø¥Ù„ØºØ§Ø¡</button>
                        <button type="submit" class="btn btn-primary btn-icon" aria-label="Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
                    </div>
                </form>
                
                <section class="reviews" id="serviceReviews" aria-label="Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©">
                    <h4>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h4>
                    <div id="reviewsList" class="loading" aria-live="polite"><i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
                </section>
            </div>
        </div>
    </div>
    
    <!-- Auth Modal -->
    <div id="authModal" class="modal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="box" aria-modal="true" aria-labelledby="authTitle">
            <div class="box-header">
                <h3 id="authTitle" style="margin:0">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
                <button class="btn btn-outline" onclick="closeAuth()" aria-label="Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
            <div class="box-body">
                <!-- Login -->
                <form id="loginForm" class="row" autocomplete="on">
                    <div class="row">
                        <label for="loginEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input id="loginEmail" type="email" placeholder="email@example.com" required aria-required="true" />
                    </div>
                    <div class="row">
                        <label for="loginPass">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input id="loginPass" type="password" placeholder="******" required aria-required="true" />
                    </div>
                    <div class="f-end">
                        <button type="submit" class="btn btn-primary btn-icon" aria-label="Ø¯Ø®ÙˆÙ„">â¡ï¸ Ø¯Ø®ÙˆÙ„</button>
                    </div>
                </form>
                
                <!-- Register -->
                <form id="registerForm" class="row" style="display:none" autocomplete="on">
                    <div class="row">
                        <label for="regEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input id="regEmail" type="email" placeholder="email@example.com" required aria-required="true" />
                    </div>
                    <div class="row row-2">
                        <div>
                            <label for="regPass">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                            <input id="regPass" type="password" minlength="6" placeholder="6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„" required aria-required="true" />
                        </div>
                        <div>
                            <label for="regConfirm">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                            <input id="regConfirm" type="password" minlength="6" placeholder="Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required aria-required="true" />
                        </div>
                    </div>
                    <div class="f-end">
                        <button type="submit" class="btn btn-primary btn-icon" aria-label="Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨">ğŸ“ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
                    </div>
                </form>
                
                <div style="margin-top:10px;text-align:center">
                    <a href="#" onclick="switchAuth()" aria-label="ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨">ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ <span id="switchLabel">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</span></a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toasts -->
    <div id="toasts" class="toast-wrap" aria-live="polite"></div>
    
    <!-- Ù†Ø§ÙØ°Ø© ØªØ¹Ø±ÙŠÙÙŠØ© Daleel ØªÙØ§Ø¹Ù„ÙŠØ© -->
    <div id="welcomeModal" tabindex="-1" role="dialog" aria-modal="true" aria-labelledby="welcomeTitle">
        <div style="
            background: #ffffff;
            padding: 30px 25px;
            max-width: 550px;
            width: 90%;
            border-radius: 12px;
            text-align: center;
            position: relative;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            border-top: 6px solid #27ae60;
            overflow: hidden;
        ">
            <!-- Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ -->
            <button id="closeModal" style="
                position: absolute;
                top: 10px;
                right: 15px;
                border: none;
                background: transparent;
                font-size: 22px;
                font-weight: bold;
                cursor: pointer;
                color: #34495e;
            " aria-label="Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©">&times;</button>
            
            <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
            <section class="welcome-section">
                <div class="welcome-content">
                    <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
                    <h2 id="welcomeTitle" class="fadeItem">
                        âœ¨ Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ "Ø¯Ù„ÙŠÙ„Ùƒ" âœ¨
                    </h2>
                    <!-- Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠØ© -->
                    <p class="fadeItem">
                        "Ø¯Ù„ÙŠÙ„Ùƒ" Ù‡Ùˆ Ù…Ù†ØµØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù…Ø¹Ø±ÙØ© <strong>Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ ÙˆØ§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª ÙˆØ§Ù„Ø±Ø³ÙˆÙ…</strong> Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆÙ…Ù† Ø£ÙˆÙ„ Ù…Ø±Ø©.
                    </p>
                    <p class="fadeItem">
                        Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø®Ø¯Ù…Ø§ØªØŒ ÙˆØ§Ø·Ù„Ø¹ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¬Ø§Ø±Ø¨ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ù„Ø¢Ø®Ø±ÙŠÙ† Ù„ØªØ¹Ø±Ù <strong>Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©</strong> Ù‚Ø¨Ù„ Ø£ÙŠ Ù…Ø´ÙˆØ§Ø± ØªÙ‚ÙˆÙ… Ø¨Ù‡.
                    </p>
                    <p class="fadeItem">
                        Ø£ÙŠ Ø´Ø®Øµ ÙŠÙ…ÙƒÙ†Ù‡ <strong>Ø¥Ø¶Ø§ÙØ© ØªØ¬Ø±Ø¨ØªÙ‡ØŒ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø§ØªØŒ ÙˆØªØ±Ùƒ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙ‡</strong> Ù„ØªÙˆÙÙŠØ± Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø¬Ù‡Ø¯ ÙˆØ§Ù„Ù…Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹.
                    </p>
                    <p class="fadeItem">
                        ğŸ’¡ <strong>Ø§Ø¨Ø¯Ø£ Ø¨Ù†ÙØ³Ùƒ!</strong> Ø´Ø§Ø±Ùƒ Ø¢Ø®Ø± Ù…Ù‡Ù…Ø© Ø£Ùˆ Ø®Ø¯Ù…Ø© Ø£Ù†Ø¬Ø²ØªÙ‡Ø§ Ù…Ù‡Ù…Ø§ ÙƒØ§Ù†Øª Ø¨Ø³ÙŠØ·Ø©ØŒ ÙÙ‚Ø¯ ØªÙƒÙˆÙ† Ø³Ø¨Ø¨Ù‹Ø§ ÙÙŠ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø´Ø®Øµ Ø¢Ø®Ø±.
                    </p>
                    <!-- Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ -->
                    <button id="startNow" class="btn-start fadeItem" aria-label="Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†">
                        ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†
                    </button>
                </div>
            </section>
        </div>
    </div>

    <!-- Firebase + App -->
    <script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-firestore-compat.js"></script>
    <script>
        // ==== Firebase Config ====
        const firebaseConfig = {
            apiKey: "AIzaSyB6TzN-QHVUOwizABYxm0Y8fkqTp1qb_qA",
            authDomain: "daleel-c4204.firebaseapp.com",
            projectId: "daleel-c4204",
            storageBucket: "daleel-c4204.appspot.com",
            messagingSenderId: "864882936232",
            appId: "1:864882936232:web:5bfc14d7c0f02559d5f02d"
        };
        
        // ==== Initialize Firebase ====
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // ==== State ====
        let currentUser = null;
        let services = [];
        let allServices = [];
        let currentServiceForReview = null;
        let currentReview = null;
        let isEditingService = false;
        let currentCategory = 'Ø§Ù„ÙƒÙ„';
        
        // ==== UI Helpers ====
        const $ = (s, p = document) => p.querySelector(s);
        const $$ = (s, p = document) => p.querySelectorAll(s);
        
        function toast(msg, type = 'success') {
            const el = document.createElement('div');
            el.className = `toast ${type}`;
            el.textContent = msg;
            $('#toasts').appendChild(el);
            setTimeout(() => el.remove(), 5000);
        }
        
        function showLoading(form) {
            const submitBtn = form.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.classList.add('disabled');
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ...';
            }
        }
        
        function hideLoading(form, originalText) {
            const submitBtn = form.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.classList.remove('disabled');
                submitBtn.innerHTML = originalText;
            }
        }
        
        function escapeHTML(str) {
            return String(str).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
        }
        
        function openModal(modalId) {
            $(`#${modalId}`).classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal(modalId) {
            $(`#${modalId}`).classList.remove('active');
            document.body.style.overflow = '';
        }
        
        // ==== Global Functions for HTML Events ====
        window.openAuth = function(mode = 'login') {
            openModal('authModal');
            if (mode === 'register') {
                $('#authTitle').textContent = 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨';
                $('#loginForm').style.display = 'none';
                $('#registerForm').style.display = 'grid';
                $('#switchLabel').textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
            } else {
                $('#authTitle').textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
                $('#loginForm').style.display = 'grid';
                $('#registerForm').style.display = 'none';
                $('#switchLabel').textContent = 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨';
            }
        };
        
        window.closeAuth = function() {
            closeModal('authModal');
            $('#loginForm').reset();
            $('#registerForm').reset();
        };
        
        window.switchAuth = function() {
            if ($('#loginForm').style.display !== 'none') {
                openAuth('register');
            } else {
                openAuth('login');
            }
        };
        
        window.logout = function() {
            auth.signOut()
                .then(() => toast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬'))
                .catch(e => toast('Ø®Ø·Ø£: ' + e.message, 'error'));
        };
        
        function mapAuthErr(e) {
            switch (e.code) {
                case 'auth/email-already-in-use': return 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„';
                case 'auth/invalid-email': return 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­';
                case 'auth/weak-password': return 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ© (6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)';
                case 'auth/user-not-found': return 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯';
                case 'auth/wrong-password': return 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
                case 'auth/invalid-credential': return 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
                case 'auth/operation-not-allowed': return 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­Ø©';
                default: return e.message;
            }
        }
        
        // ==== Service Functions ====
        window.toggleAdd = function(serviceId = null) {
            const modal = $('#addModal');
            if (modal.classList.contains('active') && !serviceId) {
                closeModal('addModal');
                return;
            }
            
            if (!currentUser && !serviceId) {
                toast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                openAuth('login');
                return;
            }
            
            if (serviceId) {
                const service = allServices.find(s => s.id === serviceId);
                if (service) {
                    isEditingService = true;
                    $('#addModalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø©';
                    $('#serviceFormSubmit').innerHTML = 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª';
                    $('#editServiceId').value = service.id;
                    $('#svcName').value = service.name || '';
                    $('#svcCat').value = service.category || '';
                    $('#svcLoc').value = service.location || '';
                    $('#svcDocs').value = service.documents || '';
                    $('#svcCost').value = service.cost || '';
                    $('#svcDur').value = service.duration || '';
                    $('#svcNotes').value = service.notes || '';
                }
            } else {
                isEditingService = false;
                $('#addModalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©';
                $('#serviceFormSubmit').innerHTML = 'ğŸ’¾ Ø­ÙØ¸';
                $('#serviceForm').reset();
                $('#editServiceId').value = '';
            }
            
            openModal('addModal');
        };
        
        async function loadServices() {
            $('#services').innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª...</div>';
            
            try {
                const snap = await db.collection('services').orderBy('createdAt', 'desc').get();
                services = [];
                allServices = [];
                
                snap.forEach(d => {
                    const data = d.data();
                    const service = { id: d.id, ...data };
                    services.push(service);
                    allServices.push(service);
                });
                
                renderServices();
                updateSearchResultsInfo(services.length);
            } catch (err) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª:', err);
                toast('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª', 'error');
                $('#services').innerHTML = '<p style="color: var(--error);">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª</p>';
            }
        }
        
        function renderServices() {
            const wrap = $('#services');
            wrap.innerHTML = '';
            
            // Filter by category if needed
            let filteredServices = [...services];
            if (currentCategory !== 'Ø§Ù„ÙƒÙ„') {
                filteredServices = services.filter(service => service.category === currentCategory);
            }
            
            if (filteredServices.length === 0) {
                $('#empty').style.display = 'block';
                return;
            }
            
            $('#empty').style.display = 'none';
            
            filteredServices.forEach(s => {
                const isOwner = currentUser && s.userId === currentUser.uid;
                const card = document.createElement('div');
                card.className = 'card';
                
                const ratingHtml = s.averageRating > 0 ? `
                    <div class="rating">
                        ${renderStars(s.averageRating)}
                        <span style="color:#666;margin-right:5px">(${s.totalReviews || 0})</span>
                    </div>
                ` : '<div style="color:#777;font-size:0.9rem">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯</div>';
                
                card.innerHTML = `
                    <h3 style="margin:.3rem 0">${escapeHTML(s.name)}</h3>
                    <div class="meta"><span>ğŸ·ï¸ ${escapeHTML(s.category)}</span><span>ğŸ“ ${escapeHTML(s.location)}</span></div>
                    ${ratingHtml}
                    <p><b>Ø§Ù„Ø£ÙˆØ±Ø§Ù‚:</b> ${escapeHTML(s.documents || '')}</p>
                    ${s.cost && s.cost !== 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' ? `<p><b>Ø§Ù„ØªÙƒÙ„ÙØ©:</b> ${escapeHTML(s.cost)}</p>` : ''}
                    ${s.duration && s.duration !== 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' ? `<p><b>Ø§Ù„Ù…Ø¯Ø©:</b> ${escapeHTML(s.duration)}</p>` : ''}
                    ${s.notes ? `<p><b>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</b> ${escapeHTML(s.notes)}</p>` : ''}
                    <small style="display:block;margin-top:8px;color:#666">Ø£Ø¶ÙŠÙØª Ø¨ÙˆØ§Ø³Ø·Ø©: ${escapeHTML(s.userEmail || 'â€”')}</small>
                    <div class="card-actions">
                        <button class="btn btn-primary btn-icon card-action-btn" onclick="openReview('${s.id}')" aria-label="Ù‚ÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©">
                            <i class="fas fa-star"></i> Ù‚ÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©
                        </button>
                        ${currentUser ? `
                            <button class="btn btn-warning btn-icon card-action-btn" onclick="toggleAdd('${s.id}')" aria-label="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø©">
                                <i class="fas fa-edit"></i> ØªØ¹Ø¯ÙŠÙ„
                            </button>
                        ` : ''}
                        ${isOwner ? `
                            <button class="btn btn-danger btn-icon card-action-btn" onclick="confirmDelete('${s.id}')" aria-label="Ø­Ø°Ù Ø§Ù„Ø®Ø¯Ù…Ø©">
                                <i class="fas fa-trash"></i> Ø­Ø°Ù
                            </button>
                        ` : ''}
                    </div>
                `;
                
                wrap.appendChild(card);
            });
        }
        
        window.confirmDelete = async function(serviceId) {
            const svc = services.find(s => s.id === serviceId);
            if (!svc || !confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø¯Ù…Ø©ØŸ')) return;
            
            try {
                await db.collection('services').doc(svc.id).delete();
                toast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø®Ø¯Ù…Ø©');
                loadServices();
                loadStats();
            } catch (err) {
                console.error(err);
                toast('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù: ' + err.message, 'error');
            }
        };
        
        // ==== Review Functions (Redesigned from scratch for scalability) ====
        window.openReview = async function(serviceId) {
            if (!currentUser) {
                toast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                openAuth('login');
                return;
            }
            
            const service = allServices.find(s => s.id === serviceId);
            if (!service) return;
            
            currentServiceForReview = service;
            currentReview = null;
            $('#reviewServiceName').textContent = service.name;
            $('#reviewRating').value = '0';
            $('#reviewComment').value = '';
            $('#reviewAccuracy').value = '';
            resetStars();
            $('#reviewForm button[type="submit"]').innerHTML = 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…';
            
            // Remove delete button if exists
            const deleteBtn = $('#reviewForm .btn-danger');
            if (deleteBtn) deleteBtn.remove();
            
            // Check if user has reviewed
            const reviewSnap = await db.collection('services').doc(serviceId).collection('reviews').doc(currentUser.uid).get();
            if (reviewSnap.exists) {
                currentReview = reviewSnap.data();
                $('#reviewRating').value = currentReview.rating;
                setStars(currentReview.rating);
                $('#reviewComment').value = currentReview.comment || '';
                $('#reviewAccuracy').value = currentReview.accuracy || '';
                $('#reviewForm button[type="submit"]').innerHTML = 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª';
                
                // Add delete button
                const fEnd = $('#reviewForm .f-end');
                const delBtn = document.createElement('button');
                delBtn.type = 'button';
                delBtn.className = 'btn btn-danger btn-icon';
                delBtn.innerHTML = '<i class="fas fa-trash"></i> Ø­Ø°Ù Ø§Ù„ØªÙ‚ÙŠÙŠÙ…';
                delBtn.onclick = deleteReview;
                fEnd.insertBefore(delBtn, fEnd.firstChild);
            }
            
            loadReviews(serviceId);
            initStarEvents(); // Initialize star events
            
            openModal('reviewModal');
        };
        
        async function deleteReview() {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ØªÙ‚ÙŠÙŠÙ…ÙƒØŸ')) return;
            
            const originalText = $('#reviewForm button[type="submit"]').innerHTML;
            showLoading($('#reviewForm'));
            
            try {
                await db.collection('services').doc(currentServiceForReview.id).collection('reviews').doc(currentUser.uid).delete();
                await updateReviewCounters(currentServiceForReview.id);
                toast('ØªÙ… Ø­Ø°Ù Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­', 'success');
                closeReview();
                loadServices();
                loadStats();
            } catch (err) {
                console.error(err);
                toast('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: ' + err.message, 'error');
            } finally {
                hideLoading($('#reviewForm'), originalText);
            }
        }
        
        window.closeReview = function() {
            closeModal('reviewModal');
            currentServiceForReview = null;
            currentReview = null;
            const reviewForm = $('#reviewForm');
            reviewForm.innerHTML = `
                <div class="row">
                    <label>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</label>
                    <div class="rating" id="ratingStars" role="radiogroup" aria-label="Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…">
                        <i class="far fa-star" data-rating="1" role="radio" aria-checked="false" tabindex="0"></i>
                        <i class="far fa-star" data-rating="2" role="radio" aria-checked="false" tabindex="-1"></i>
                        <i class="far fa-star" data-rating="3" role="radio" aria-checked="false" tabindex="-1"></i>
                        <i class="far fa-star" data-rating="4" role="radio" aria-checked="false" tabindex="-1"></i>
                        <i class="far fa-star" data-rating="5" role="radio" aria-checked="false" tabindex="-1"></i>
                    </div>
                    <input type="hidden" id="reviewRating" value="0" required aria-required="true" />
                </div>
                <div class="row">
                    <label for="reviewComment">Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <textarea id="reviewComment" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ø¹Ù† Ø§Ù„Ø®Ø¯Ù…Ø©..."></textarea>
                </div>
                <div class="row">
                    <label for="reviewAccuracy">Ù‡Ù„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØµØ­ÙŠØ­Ø©ØŸ</label>
                    <select id="reviewAccuracy" required aria-required="true">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</option>
                        <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…ØŒ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØµØ­ÙŠØ­Ø©</option>
                        <option value="Ø¬Ø²Ø¦ÙŠØ§Ù‹">Ø¬Ø²Ø¦ÙŠØ§Ù‹ØŒ Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªØ­ØªØ§Ø¬ ØªØ­Ø¯ÙŠØ«</option>
                        <option value="Ù„Ø§">Ù„Ø§ØŒ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©</option>
                    </select>
                </div>
                <div class="f-end">
                    <button type="button" class="btn" onclick="closeReview()" aria-label="Ø¥Ù„ØºØ§Ø¡">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="submit" class="btn btn-primary btn-icon" aria-label="Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
                </div>
            `;
            initStarEvents();
        };
        
        function resetStars() {
            const stars = $$('#ratingStars i');
            stars.forEach(star => {
                star.classList.remove('fas');
                star.classList.add('far');
            });
        }
        
        function setStars(rating) {
            const stars = $$('#ratingStars i');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.remove('far');
                    star.classList.add('fas');
                } else {
                    star.classList.remove('fas');
                    star.classList.add('far');
                }
            });
        }
        
        function initStarEvents() {
            const stars = $$('#ratingStars i');
            if (stars.length > 0) {
                stars.forEach(star => {
                    star.addEventListener('mouseenter', function() {
                        const rating = parseInt(this.getAttribute('data-rating'));
                        setStars(rating);
                    });
                    
                    star.addEventListener('mouseleave', function() {
                        const currentRating = parseInt($('#reviewRating').value);
                        setStars(currentRating);
                    });
                    
                    star.addEventListener('click', function() {
                        const rating = parseInt(this.getAttribute('data-rating'));
                        $('#reviewRating').value = rating;
                        setStars(rating);
                    });
                });
            }
        }
        
        async function loadReviews(serviceId) {
            const reviewsList = $('#reviewsList');
            reviewsList.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
            
            try {
                const reviewsSnap = await db.collection('services').doc(serviceId).collection('reviews').orderBy('createdAt', 'desc').get();
                
                reviewsList.innerHTML = '';
                
                if (reviewsSnap.empty) {
                    reviewsList.innerHTML = '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯</p>';
                    return;
                }
                
                reviewsSnap.forEach(doc => {
                    const review = doc.data();
                    const reviewEl = document.createElement('div');
                    reviewEl.className = 'review-item';
                    
                    const date = review.createdAt ? review.createdAt.toDate().toLocaleDateString('ar-EG', { year: 'numeric', month: 'short', day: 'numeric' }) : 'ØªØ§Ø±ÙŠØ® ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                    
                    reviewEl.innerHTML = `
                        <div class="review-header">
                            <div>${escapeHTML(review.userEmail || 'Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¬Ù‡ÙˆÙ„')}</div>
                            <div>${date}</div>
                        </div>
                        <div class="rating">
                            ${renderStars(review.rating)}
                        </div>
                        <div class="review-accuracy"><strong>Ø¯Ù‚Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª:</strong> ${escapeHTML(review.accuracy)}</div>
                        ${review.comment ? `<div class="review-comment">${escapeHTML(review.comment)}</div>` : ''}
                    `;
                    
                    if (review.userId === currentUser.uid) {
                        const actions = document.createElement('div');
                        actions.style.marginTop = '10px';
                        actions.style.display = 'flex';
                        actions.style.gap = '8px';
                        actions.style.justifyContent = 'flex-end';

                        const editBtn = document.createElement('button');
                        editBtn.className = 'btn btn-warning btn-icon';
                        editBtn.innerHTML = '<i class="fas fa-edit"></i> ØªØ¹Ø¯ÙŠÙ„';
                        editBtn.onclick = function() {
                            currentReview = review;
                            $('#reviewRating').value = review.rating;
                            setStars(review.rating);
                            $('#reviewComment').value = review.comment || '';
                            $('#reviewAccuracy').value = review.accuracy || '';
                            $('#reviewForm button[type="submit"]').innerHTML = 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª';

                            if (!$('#reviewForm .btn-danger')) {
                                const fEnd = $('#reviewForm .f-end');
                                const delBtn = document.createElement('button');
                                delBtn.type = 'button';
                                delBtn.className = 'btn btn-danger btn-icon';
                                delBtn.innerHTML = '<i class="fas fa-trash"></i> Ø­Ø°Ù Ø§Ù„ØªÙ‚ÙŠÙŠÙ…';
                                delBtn.onclick = deleteReview;
                                fEnd.insertBefore(delBtn, fEnd.firstChild);
                            }
                        };

                        const delBtn = document.createElement('button');
                        delBtn.className = 'btn btn-danger btn-icon';
                        delBtn.innerHTML = '<i class="fas fa-trash"></i> Ø­Ø°Ù';
                        delBtn.onclick = deleteReview;

                        actions.appendChild(editBtn);
                        actions.appendChild(delBtn);
                        reviewEl.appendChild(actions);
                    }

                    reviewsList.appendChild(reviewEl);
                });
            } catch (err) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª:', err);
                reviewsList.innerHTML = '<p style="color: var(--error);">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</p>';
            }
        }
        
        async function updateReviewCounters(serviceId) {
            const reviewsSnap = await db.collection('services').doc(serviceId).collection('reviews').get();
            let totalRating = 0;
            let count = 0;
            
            reviewsSnap.forEach(doc => {
                const r = doc.data();
                totalRating += r.rating;
                count++;
            });
            
            const average = count > 0 ? totalRating / count : 0;
            
            await db.collection('services').doc(serviceId).update({
                averageRating: average,
                totalReviews: count
            });
        }
        
        window.renderStars = function(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= rating) {
                    stars += '<i class="fas fa-star"></i>';
                } else if (i - 0.5 <= rating) {
                    stars += '<i class="fas fa-star-half-alt"></i>';
                } else {
                    stars += '<i class="far fa-star"></i>';
                }
            }
            return stars;
        };
        
        // ==== Search and Filter Functions ====
        window.searchServices = function() {
            const searchTerm = $('#searchInput').value.trim().toLowerCase();
            filterServices(searchTerm);
        };
        
        function filterServices(searchTerm = '') {
            let filtered = [...allServices];
            
            if (searchTerm) {
                const searchWords = searchTerm.split(/\s+/).filter(word => word.length > 0);
                
                filtered = filtered.filter(service => {
                    const combinedText = [
                        service.name?.toLowerCase() || '',
                        service.location?.toLowerCase() || '',
                        service.documents?.toLowerCase() || '',
                        service.notes?.toLowerCase() || '',
                        service.category?.toLowerCase() || '',
                        service.cost?.toLowerCase() || '',
                        service.duration?.toLowerCase() || ''
                    ].join(' ');
                    
                    return searchWords.every(word => combinedText.includes(word));
                });
            }
            
            services = filtered;
            renderServices();
            updateSearchResultsInfo(filtered.length);
        }
        
        window.filterByCategory = function(category) {
            currentCategory = category;
            
            // Update active button
            $$('.filter-btn').forEach(btn => {
                if (btn.dataset.category === category) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            renderServices();
            updateSearchResultsInfo(services.length);
        };
        
        function updateSearchResultsInfo(count) {
            const searchTerm = $('#searchInput').value.trim();
            
            let infoText = '';
            if (searchTerm) {
                infoText = `Ø¹Ø±Ø¶ ${count} Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† "${searchTerm}"`;
            } else if (currentCategory !== 'Ø§Ù„ÙƒÙ„') {
                infoText = `Ø¹Ø±Ø¶ ${count} Ø®Ø¯Ù…Ø© ÙÙŠ Ù‚Ø³Ù… "${currentCategory}"`;
            } else {
                infoText = `Ø¹Ø±Ø¶ ${count} Ø®Ø¯Ù…Ø©`;
            }
            
            $('#searchResultsInfo').textContent = infoText;
        }
        
        function showSearchSuggestions(searchTerm) {
            const suggestionsContainer = $('#searchSuggestions');
            
            if (!searchTerm || allServices.length === 0) {
                suggestionsContainer.style.display = 'none';
                return;
            }
            
            const allWords = new Set();
            allServices.forEach(service => {
                const fields = [
                    service.name,
                    service.location,
                    service.documents,
                    service.notes,
                    service.category,
                    service.cost,
                    service.duration
                ];
                
                fields.forEach(field => {
                    if (field) {
                        field.toString().split(/\s+/).forEach(word => {
                            if (word.length > 2) {
                                allWords.add(word.toLowerCase());
                            }
                        });
                    }
                });
            });
            
            const matchingWords = Array.from(allWords).filter(word => 
                word.includes(searchTerm)
            ).slice(0, 10);
            
            if (matchingWords.length > 0) {
                suggestionsContainer.innerHTML = '';
                matchingWords.forEach(word => {
                    const suggestion = document.createElement('div');
                    suggestion.className = 'search-suggestion';
                    suggestion.textContent = word;
                    suggestion.addEventListener('click', () => {
                        $('#searchInput').value = word;
                        suggestionsContainer.style.display = 'none';
                        searchServices();
                    });
                    suggestionsContainer.appendChild(suggestion);
                });
                suggestionsContainer.style.display = 'block';
            } else {
                suggestionsContainer.style.display = 'none';
            }
        }
        
        // ==== Stats Functions ====
        async function loadStats() {
            try {
                const servicesSnap = await db.collection('services').get();
                $('#statServices').textContent = servicesSnap.size;
                const users = new Set();
                let totalReviews = 0;
                
                servicesSnap.forEach(d => {
                    const data = d.data();
                    const u = data.userId;
                    if (u) users.add(u);
                    totalReviews += data.totalReviews || 0;
                });
                
                $('#statUsers').textContent = users.size;
                $('#statReviews').textContent = totalReviews;
            } catch (e) {
                $('#statServices').textContent = '0';
                $('#statUsers').textContent = '0';
                $('#statReviews').textContent = '0';
            }
        }
        
        // ==== Welcome Modal Functions ====
        function showWelcomeModal() {
            const modal = $('#welcomeModal');
            const fadeItems = $$('.fadeItem');
            const startBtn = $('#startNow');
            const closeBtn = $('#closeModal');
            
            // Show modal on every visit (for testing) - ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ± Ù‡Ø°Ø§ Ù„ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ localStorage Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            fadeItems.forEach((el, i) => {
                setTimeout(() => { 
                    el.classList.add('show'); 
                }, i * 600);
            });
            
            setTimeout(() => { 
                startBtn.classList.add('show'); 
            }, fadeItems.length * 600);
            
            // Auto close after 120 seconds
            setTimeout(hideWelcomeModal, 120000);
            
            function hideWelcomeModal() {
                modal.style.display = 'none';
                document.body.style.overflow = '';
            }
            
            closeBtn.onclick = hideWelcomeModal;
            startBtn.onclick = hideWelcomeModal;
        }
        
        // ==== Event Listeners ====
        document.addEventListener('DOMContentLoaded', function() {
            loadServices();
            loadStats();
            initStarEvents();
            showWelcomeModal();
            
            // Auth Handlers
            $('#registerForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const originalText = $('#registerForm button[type="submit"]').innerHTML;
                showLoading($('#registerForm'));
                const email = $('#regEmail').value.trim();
                const pass = $('#regPass').value;
                const confirm = $('#regConfirm').value;
                
                if (pass !== confirm) {
                    toast('ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©', 'error');
                    hideLoading($('#registerForm'), originalText);
                    return;
                }
                
                try {
                    await auth.createUserWithEmailAndPassword(email, pass);
                    toast('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
                    closeAuth();
                } catch (err) {
                    toast(mapAuthErr(err), 'error');
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„:', err);
                } finally {
                    hideLoading($('#registerForm'), originalText);
                }
            });
            
            $('#loginForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const originalText = $('#loginForm button[type="submit"]').innerHTML;
                showLoading($('#loginForm'));
                const email = $('#loginEmail').value.trim();
                const pass = $('#loginPass').value;
                
                try {
                    await auth.signInWithEmailAndPassword(email, pass);
                    toast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
                    closeAuth();
                } catch (err) {
                    toast(mapAuthErr(err), 'error');
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„:', err);
                } finally {
                    hideLoading($('#loginForm'), originalText);
                }
            });
            
            // Service Form Submit
            $('#serviceForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                if (!currentUser) {
                    toast('Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                    return;
                }
                const originalText = $('#serviceForm button[type="submit"]').innerHTML;
                showLoading($('#serviceForm'));
                const name = $('#svcName').value.trim();
                const category = $('#svcCat').value;
                const location = $('#svcLoc').value.trim();
                const documents = $('#svcDocs').value.trim();
                const cost = $('#svcCost').value.trim() || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                const duration = $('#svcDur').value.trim() || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                const notes = $('#svcNotes').value.trim();
                const serviceId = $('#editServiceId').value;
                
                if (!name || !category || !location || !documents) {
                    toast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                    hideLoading($('#serviceForm'), originalText);
                    return;
                }
                
                try {
                    if (isEditingService && serviceId) {
                        const serviceRef = db.collection('services').doc(serviceId);
                        await serviceRef.update({
                            name,
                            category,
                            location,
                            documents,
                            cost,
                            duration,
                            notes,
                            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                        toast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    } else {
                        await db.collection('services').add({
                            name,
                            category,
                            location,
                            documents,
                            cost,
                            duration,
                            notes,
                            userId: currentUser.uid,
                            userEmail: currentUser.email,
                            averageRating: 0,
                            totalReviews: 0,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                        toast('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    }
                    
                    $('#serviceForm').reset();
                    toggleAdd(); // Close modal after save
                    loadServices();
                    loadStats();
                } catch (err) {
                    console.error(err);
                    toast('Ø®Ø·Ø£: ' + err.message, 'error');
                } finally {
                    hideLoading($('#serviceForm'), originalText);
                }
            });
            
            // Review Form Submit
            $('#reviewModal').addEventListener('submit', async (e) => {
                if (e.target.id !== 'reviewForm') return;
                e.preventDefault();
                if (!currentUser || !currentServiceForReview) return;
                
                const originalText = $('#reviewForm button[type="submit"]').innerHTML;
                showLoading($('#reviewForm'));
                
                const rating = parseInt($('#reviewRating').value);
                const comment = $('#reviewComment').value.trim();
                const accuracy = $('#reviewAccuracy').value;
                
                if (!rating || !accuracy) {
                    toast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØªØ­Ø¯ÙŠØ¯ Ø¯Ù‚Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'error');
                    hideLoading($('#reviewForm'), originalText);
                    return;
                }
                
                try {
                    const reviewData = { 
                        userId: currentUser.uid, 
                        userEmail: currentUser.email, 
                        rating, 
                        comment, 
                        accuracy, 
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    await db.collection('services').doc(currentServiceForReview.id).collection('reviews').doc(currentUser.uid).set(reviewData);
                    await updateReviewCounters(currentServiceForReview.id);
                    
                    toast(currentReview ? 'ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­' : 'Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙ‚ÙŠÙŠÙ…Ùƒ Ø§Ù„Ø®Ø¯Ù…Ø©!', 'success');
                    closeReview();
                    loadServices();
                    loadStats();
                } catch (err) {
                    console.error(err);
                    toast('Ø®Ø·Ø£ ÙÙŠ ' + (currentReview ? 'ØªØ¹Ø¯ÙŠÙ„' : 'Ø¥Ø¶Ø§ÙØ©') + ' Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: ' + err.message, 'error');
                } finally {
                    hideLoading($('#reviewForm'), originalText);
                }
            });
            
            // Search Input
            $('#searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    searchServices();
                }
            });
            
            $('#searchInput').addEventListener('input', function() {
                const searchTerm = this.value.trim().toLowerCase();
                showSearchSuggestions(searchTerm);
                searchServices();
            });
            
            // Hide Suggestions on Click Outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.search-container')) {
                    $('#searchSuggestions').style.display = 'none';
                }
            });
            
            // Modal Close on Esc
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeModal('authModal');
                    closeModal('addModal');
                    closeReview();
                    $('#welcomeModal').style.display = 'none';
                    document.body.style.overflow = '';
                }
            });
            
            document.querySelectorAll('.modal').forEach(m => {
                m.addEventListener('click', (e) => {
                    if (e.target === m) {
                        if (m.id === 'reviewModal') {
                            closeReview();
                        } else if (m.id === 'welcomeModal') {
                            $('#welcomeModal').style.display = 'none';
                            document.body.style.overflow = '';
                        } else {
                            closeModal(m.id);
                        }
                    }
                });
            });
        });
        
        // Auth State Listener
        auth.onAuthStateChanged((user) => {
            currentUser = user;
            $('#loginBtn').style.display = user ? 'none' : 'inline-block';
            $('#registerBtn').style.display = user ? 'none' : 'inline-block';
            $('#logoutBtn').style.display = user ? 'inline-block' : 'none';
            $('#addServiceNav').style.display = user ? 'inline-block' : 'none';
            $('#addServiceTop').style.display = user ? 'inline-block' : 'none';
            loadServices();
            loadStats();
        });
    </script>
</body>

</html>
